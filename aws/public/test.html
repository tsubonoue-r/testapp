<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ä½œãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        button {
            padding: 12px 24px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸ“± å·¥äº‹å†™çœŸã‚·ã‚¹ãƒ†ãƒ  å‹•ä½œãƒ†ã‚¹ãƒˆ</h1>

    <div class="test-section">
        <h2>1. åŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="test1()">ã‚¯ãƒªãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</button>
        <div id="result1" class="result"></div>
    </div>

    <div class="test-section">
        <h2>2. ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="window.testFunction()">windowé–¢æ•°ãƒ†ã‚¹ãƒˆ</button>
        <div id="result2" class="result"></div>
    </div>

    <div class="test-section">
        <h2>3. APIæ¥ç¶šãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testAPI()">APIå‘¼ã³å‡ºã—ãƒ†ã‚¹ãƒˆ</button>
        <div id="result3" class="result"></div>
    </div>

    <div class="test-section">
        <h2>4. app.jsãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testAppJS()">app.jsç¢ºèª</button>
        <div id="result4" class="result"></div>
    </div>

    <div class="test-section">
        <h2>5. ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="showTestModal()">ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º</button>
        <div id="testModal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.3); z-index:9999;">
            <h3>ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«</h3>
            <p>ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼</p>
            <button onclick="hideTestModal()">é–‰ã˜ã‚‹</button>
        </div>
        <div id="modalOverlay" style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:9998;" onclick="hideTestModal()"></div>
    </div>

    <script>
        // ãƒ†ã‚¹ãƒˆ1: åŸºæœ¬çš„ãªã‚¯ãƒªãƒƒã‚¯
        function test1() {
            document.getElementById('result1').innerHTML = 'âœ… ãƒœã‚¿ãƒ³ãŒå‹•ä½œã—ã¦ã„ã¾ã™ï¼';
            console.log('Test 1: OK');
        }

        // ãƒ†ã‚¹ãƒˆ2: windowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆçµŒç”±
        window.testFunction = function() {
            document.getElementById('result2').innerHTML = 'âœ… windowçµŒç”±ã®é–¢æ•°ãŒå‹•ä½œã—ã¦ã„ã¾ã™ï¼';
            console.log('Test 2: OK');
        };

        // ãƒ†ã‚¹ãƒˆ3: APIæ¥ç¶š
        async function testAPI() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                document.getElementById('result3').innerHTML = `âœ… APIæ¥ç¶šæˆåŠŸ: ${data.service}`;
                console.log('Test 3: OK', data);
            } catch (error) {
                document.getElementById('result3').innerHTML = `âŒ APIæ¥ç¶šå¤±æ•—: ${error.message}`;
                console.error('Test 3: Error', error);
            }
        }

        // ãƒ†ã‚¹ãƒˆ4: app.jsèª­ã¿è¾¼ã¿ç¢ºèª
        function testAppJS() {
            let result = '';

            // app.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã®ç¢ºèª
            const scripts = document.querySelectorAll('script[src*="app.js"]');
            result += `ğŸ“„ app.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°: ${scripts.length}å€‹<br>`;
            if (scripts.length > 0) {
                result += `   ãƒ‘ã‚¹: ${scripts[0].src}<br>`;
            }

            // window.appã®ç¢ºèª
            if (typeof window.app !== 'undefined') {
                result += 'âœ… window.app ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™<br>';
                result += `   å‹: ${typeof window.app}<br>`;
                if (window.app.projects) {
                    result += `   æ¡ˆä»¶æ•°: ${window.app.projects.length}<br>`;
                }
            } else {
                result += 'âŒ window.app ãŒæœªå®šç¾©<br>';
            }

            // Appã‚¯ãƒ©ã‚¹ã®ç¢ºèª
            if (typeof App !== 'undefined') {
                result += 'âœ… Appã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™<br>';
            } else {
                result += 'âŒ Appã‚¯ãƒ©ã‚¹ãŒæœªå®šç¾©<br>';
            }

            document.getElementById('result4').innerHTML = result;
            console.log('Test 4 è©³ç´°:', {
                scripts: scripts.length,
                windowApp: typeof window.app,
                AppClass: typeof App
            });
        }

        // ãƒ†ã‚¹ãƒˆ5: ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º/éè¡¨ç¤º
        function showTestModal() {
            document.getElementById('testModal').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
        }

        function hideTestModal() {
            document.getElementById('testModal').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'none';
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®æƒ…å ±è¡¨ç¤º
        window.addEventListener('load', () => {
            console.log('=== å‹•ä½œãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº† ===');
            console.log('ç¾åœ¨ã®URL:', window.location.href);
            console.log('appå¤‰æ•°:', typeof window.app);
            console.log('=====================');
        });
    </script>

    <!-- app.jsã‚’èª­ã¿è¾¼ã‚“ã§ãƒ†ã‚¹ãƒˆ -->
    <script src="/app.js?v=2"></script>
    <script>
        // app.jsèª­ã¿è¾¼ã¿å¾Œã®ç¢ºèª
        console.log('app.jsèª­ã¿è¾¼ã¿è©¦è¡Œå¾Œ:', typeof window.app);
    </script>
</body>
</html>
